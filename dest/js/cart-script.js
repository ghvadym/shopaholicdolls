(function(t){t(document).ready(function(){var u=ajaxcart.ajaxurl;function s(){t(".cart_totals, .woocommerce-cart-form").block({message:null,overlayCSS:{background:"#fff",opacity:.6}}).addClass("processing")}function p(){t(".cart_totals, .woocommerce-cart-form").unblock().removeClass("processing")}function d(){t(document.body).trigger("wc_update_cart"),v()}function v(){t.ajax({type:"POST",url:u,data:{action:"update_mini_cart_items_html"},success:function(e){e.html&&t(".header_cart").html(e.html)},error:function(e){console.log("error",e)}})}t(document).on("change",".product-quantity select.qty",function(){var e={action:"update_cart",security:ajaxcart.update_cart_nonce,cart_item_key:t(this).attr("name").match(/\[(.*?)\]/)[1],quantity:t(this).val()};t.ajax({type:"POST",url:u,data:e,beforeSend:function(){s()},success:function(a){d()},error:function(a){console.log("error",a)}})}),t(document).on("click",".restore-button, .restore-product",function(){var e=t(this),a=e.data("cart_item_key");t.ajax({type:"POST",url:ajaxcart.ajaxurl,data:{action:"update_cart",security:ajaxcart.update_cart_nonce,cart_item_key:a,restore_product:!0},beforeSend:function(){s()},success:function(o){o.success&&d()},error:function(o){console.log("error",o)}})}),t(document).on("click",".product-bottom .remove",function(e){e.preventDefault();var a=t(this),o=a.data("cart_item_key"),c=a.closest(".cart-table-row"),n={action:"update_cart",security:ajaxcart.update_cart_nonce,cart_item_key:o,remove_product:!0};t.ajax({type:"POST",url:ajaxcart.ajaxurl,data:n,beforeSend:function(){s()},success:function(r){if(r.success){t(".cart-sidebar__subtotal .woocommerce-Price-amount").html(r.subtotal),t(".cart-sidebar__total--total .woocommerce-Price-amount").html(r.cart_total);var i=t('<div class="restore-product" data-cart_item_key="'+o+'" ></div>');i.append('<svg xmlns="http://www.w3.org/2000/svg" width="17" height="16" viewBox="0 0 17 16" fill="none"><path d="M3.16406 5.6665H10.4974C12.3383 5.6665 13.8307 7.15889 13.8307 8.99984C13.8307 10.8408 12.3383 12.3332 10.4974 12.3332H5.83073M3.16406 5.6665L5.16406 3.6665M3.16406 5.6665L5.16406 7.6665" stroke="#1B1B1B" stroke-linecap="round" stroke-linejoin="round"/></svg>'),i.append('<div class="restore-button" data-cart_item_key="'+o+'" data-restored_product_id="'+r.restored_product_id+'" data-restored_variation_id="'+r.restored_variation_id+'">'+ajaxcart.restore_item_message+"</div>"),c.before(i).hide(),p(),setTimeout(function(){s(),d()},2e3),setTimeout(function(){b()},3e3)}else t(".cart-sidebar__total, .woocommerce-cart-form").unblock(),console.log("Error: "+r.message),console.log("Additional error details:",r.debug)},error:function(r){console.log("error",r)}})}),t(document).on("click",".edit-variation",function(e){e.preventDefault();var a=t(this).closest(".product-info");t(a).find(".product-variations").hide(),t(a).find(".variation-wrapper").show(),t(this).addClass("active")}),t(document).on("click",".cancel-button",function(e){e.preventDefault();var a=t(this).closest(".product-info").find(".product-variations");t(this).closest(".product-info").find(".edit-variation").removeClass("active"),t(this).closest(".product-info").find(".variation-wrapper").hide(),t(a).show()}),t(document).on("click",".confirm-button",function(e){e.preventDefault();var a=t(this).attr("data-cart_item_key"),o={},c=t(this).closest(".variation-wrapper").find("select");t(c).each(function(n,r){var i=t(r).val();if(i!==""){var y=t(r).attr("data-attribute_name");o[y]=i}}),t(".edit-variation").removeClass("active"),t.ajax({type:"POST",url:u,data:{action:"update_cart_variation",cart_item_key:a,variation:o,security:ajaxcart.update_cart_nonce},dataType:"json",beforeSend:function(){s()},success:function(n){d()},error:function(n,r,i){console.error("AJAX error:",n,r,i)}})}),f();function f(){var e=t(".cart_item");e.length>0&&t(e).each(function(a,o){var c=t(o).find(".variation-wrapper select");c&&c.length>0&&t(c).each(function(n,r){var i=t(r).find("option");t(r).find("option:first").remove(),i&&i.length===2&&(t(r).find("option").prop("selected",!0).trigger("change"),t(r).prop("disabled",!0))})})}t(document).on("click",".cart-sidebar__top",function(){var e=t(this).parent(".cart-sidebar__item"),a=e.find(".cart-sidebar__content"),o=e.find("svg");a.toggleClass("open"),o.toggleClass("rotate")});var _=t("#order_note");if(t(_).length>0){let e=function(){t(_).blur(),m({order_note:t(_).val()},t(_).closest(".cart-sidebar__content"))};var x=e,l,h=3e3;t(document).on("keyup","#order_note",function(a){a.keyCode===13?e():(clearTimeout(l),l=setTimeout(e,h))}),t(document).on("keydown","#order_note",function(){clearTimeout(l)})}var g=t(".cart-sidebar__samples--item");g.length&&t(document).on("click",".cart-sidebar__samples--item",function(){var e=t(".cart-sidebar__samples--item");t(e).removeClass("active"),t(e).find('input[name="sample"]').prop("checked",!1),t(this).addClass("active"),t(this).find('input[name="sample"]').prop("checked",!0),m({product_sample:t(this).find('input[name="sample"]').attr("data-key")},t(this).closest(".cart-sidebar__content"))}),t(document).on("submit","#apply_coupon",function(e){e.preventDefault();var a=t(this).closest(".cart-sidebar__promo"),o=t(this),c=t("#coupon_code").val(),n=t(a).find(".form_error_message");t.ajax({type:"POST",url:ajaxcart.ajaxurl,data:{action:"cart_apply_coupon",coupon_code:c,security:ajaxcart.update_cart_nonce},beforeSend:function(){t(o).addClass("_spinner")},success:function(r){r.error&&r.message&&t(n).html(r.message),r.success&&(t(n).html(""),t(o).trigger("reset"),s(),d()),t(o).removeClass("_spinner")},error:function(r){console.log(r)}})}),t(document).on("submit","#apply_gift_card",function(e){e.preventDefault();var a=t(this).closest(".cart-sidebar__gift"),o=t(this),c=t("#gift_card_code").val(),n=t(a).find(".form_error_message");t.ajax({type:"POST",url:ajaxcart.ajaxurl,data:{action:"cart_apply_gift_card",gift_code:c,security:ajaxcart.update_cart_nonce},beforeSend:function(){t(o).addClass("_spinner")},success:function(r){r.error&&r.message&&t(n).html(r.message),r.success&&(t(n).html(""),t(o).trigger("reset"),s(),d()),t(o).removeClass("_spinner")},error:function(r){console.log(r)}})}),t(".cart-sidebar__points--item .reward_product_item").length&&(t(document).on("change",".cart-sidebar__points--item .reward_product_item",function(){t("#reward_products").submit()}),t(document).on("submit","#reward_products",function(e){e.preventDefault();var a=t(this).closest(".cart-sidebar__points"),o=new FormData(t(this)[0]);o.append("action","cart_update_rewards"),o.append("security",ajaxcart.update_cart_nonce),t.ajax({type:"POST",url:u,data:o,processData:!1,contentType:!1,dataType:"json",beforeSend:function(){t(a).addClass("_spinner")},success:function(c){c.html&&t(a).html(c.html),t(a).removeClass("_spinner"),s(),d()},error:function(c){console.log("error",c)}})}));function b(){var e=t(".cart-sidebar__points");e&&t.ajax({type:"POST",url:u,data:{action:"cart_update_rewards_html"},beforeSend:function(){t(e).addClass("_spinner")},success:function(a){a.html&&t(e).html(a.html),a.redirect&&(window.location.href=a.redirect),t(e).removeClass("_spinner")},error:function(a){console.log("error",a)}})}function m(e={},a=""){var o=t.extend({action:"update_order_session"},e);t.ajax({type:"POST",url:ajaxcart.ajaxurl,data:o,beforeSend:function(){a&&t(a).addClass("_spinner")},success:function(c){c&&c.message&&console.log(c.message),a&&t(a).removeClass("_spinner")},error:function(c){console.log("error",c)}})}t(document.body).on("updated_cart_totals",function(){f()})})})(jQuery);
